/*
	Masked Input plugin for jQuery
	Copyright (c) 2007-2011 Josh Bush (digitalbush.com)
	Licensed under the MIT license (http://digitalbush.com/projects/masked-input-plugin/#license) 
	Version: 1.3
*/
!function(r){var w=(r.browser.msie?"paste":"input")+".mask",y=window.orientation!=undefined;r.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},r.fn.extend({caret:function(t,n){if(0!=this.length){if("number"==typeof t)return n="number"==typeof n?n:t,this.each(function(){if(this.setSelectionRange)this.setSelectionRange(t,n);else if(this.createTextRange){var e=this.createTextRange();e.collapse(!0),e.moveEnd("character",n),e.moveStart("character",t),e.select()}});if(this[0].setSelectionRange)t=this[0].selectionStart,n=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var e=document.selection.createRange();t=0-e.duplicate().moveStart("character",-1e5),n=t+e.text.length}return{begin:t,end:n}}},unmask:function(){return this.trigger("unmask")},mask:function(n,v){if(!n&&0<this.length)return r(this[0]).data(r.mask.dataName)();v=r.extend({placeholder:"_",completed:null},v);var a=r.mask.definitions,g=[],p=n.length,k=null,b=n.length;return r.each(n.split(""),function(e,t){"?"==t?(b--,p=e):a[t]?(g.push(new RegExp(a[t])),null==k&&(k=g.length-1)):g.push(null)}),this.trigger("unmask").each(function(){function c(e){for(;++e<=b&&!g[e];);return e}function i(e){for(;0<=--e&&!g[e];);return e}function o(e,t){if(!(e<0)){for(var n=e,a=c(t);n<b;n++)if(g[n]){if(!(a<b&&g[n].test(d[a])))break;d[n]=d[a],d[a]=v.placeholder,a=c(a)}s(),h.caret(Math.max(k,e))}}function l(e){for(var t=e,n=v.placeholder;t<b;t++)if(g[t]){var a=c(t),r=d[t];if(d[t]=n,!(a<b&&g[a].test(r)))break;n=r}}function e(e){var t=e.which;if(8==t||46==t||y&&127==t){var n=h.caret(),a=n.begin,r=n.end;return r-a==0&&(a=46!=t?i(a):r=c(a-1),r=46==t?c(r):r),u(a,r),o(a,r-1),!1}if(27==t)return h.val(m),h.caret(0,f()),!1}function t(e){var t=e.which,n=h.caret();if(e.ctrlKey||e.altKey||e.metaKey||t<32)return!0;if(t){n.end-n.begin!=0&&(u(n.begin,n.end),o(n.begin,n.end-1));var a=c(n.begin-1);if(a<b){var r=String.fromCharCode(t);if(g[a].test(r)){l(a),d[a]=r,s();var i=c(a);h.caret(i),v.completed&&b<=i&&v.completed.call(h)}}return!1}}function u(e,t){for(var n=e;n<t&&n<b;n++)g[n]&&(d[n]=v.placeholder)}function s(){return h.val(d.join("")).val()}function f(e){for(var t=h.val(),n=-1,a=0,r=0;a<b;a++)if(g[a]){for(d[a]=v.placeholder;r++<t.length;){var i=t.charAt(r-1);if(g[a].test(i)){d[a]=i,n=a;break}}if(r>t.length)break}else d[a]==t.charAt(r)&&a!=p&&(r++,n=a);return!e&&n+1<p?(h.val(""),u(0,b)):(e||p<=n+1)&&(s(),e||h.val(h.val().substring(0,n+1))),p?a:k}var h=r(this),d=r.map(n.split(""),function(e){if("?"!=e)return a[e]?v.placeholder:e}),m=h.val();h.data(r.mask.dataName,function(){return r.map(d,function(e,t){return g[t]&&e!=v.placeholder?e:null}).join("")}),h.attr("readonly")||h.one("unmask",function(){h.unbind(".mask").removeData(r.mask.dataName)}).bind("focus.mask",function(){m=h.val();var e=f();s();var t=function(){e==n.length?h.caret(0,e):h.caret(e)};(r.browser.msie?t:function(){setTimeout(t,0)})()}).bind("blur.mask",function(){f(),h.val()!=m&&h.change()}).bind("keydown.mask",e).bind("keypress.mask",t).bind(w,function(){setTimeout(function(){h.caret(f(!0))},0)}),f()})}})}(jQuery);