function abortendorsement(){$("#policyactions").slideUp(300),$("#policyactions").html(""),$("#policyfields").slideDown(300),$("#policytransinv").slideDown(300),$("#transactiontable").slideDown(300),$("#invoicetable").slideDown(300),$("#editpolbutton").removeAttr("disabled"),$("#cancelpolbutton").removeAttr("disabled"),$("#endorsepolbutton").removeAttr("disabled")}function feechangecalc(){var e=$("#policypremiumtransaction_fees").val().replace(/[^0-9\.\(\)]+/g,""),t=parseFloat(e).toFixed(2),a=$("#policypremiumtransaction_base_premium").val().replace(/[^0-9\.\(\)]+/g,""),r=parseFloat(a).toFixed(2);isNaN(r)&&(r=0),$("#policypremiumtransaction_total_premium").val(Number(r)+Number(t)),$("#policypremiumtransaction_total_premium").effect("highlight",1e3),$("#policypremiumtransaction_total_premium").formatCurrency()}function recalculatefees(){var a=0;$(".complexfee input").each(function(){var e=$(this).val().replace(/[^0-9\.]+/g,""),t=parseFloat(e).toFixed(2);isNaN(Number(t))&&(t=0),a=Number(a)+Number(t)}),$("#policypremiumtransaction_complexfees").val(a).formatCurrency(),totalpremcalc()}$("#gobackendorse").click(function(){abortendorsement()}),$("#endorsetype").change(function(){"Return"==$("#endorsetype").val()?$("#recmoney").slideDown(300):$("#recmoney").hide()}),$("#policypremiumtransaction_base_premium").change(function(){$(this).formatCurrency(),feecalc(),totalpremcalc()}),$("#policypremiumtransaction_taxes").change(function(){$(this).formatCurrency(),totalpremcalc()}),$("#policypremiumtransaction_fees").change(function(){$(this).formatCurrency(),feechangecalc()}),$("#policypremiumtransaction_complexfees").change(function(){$(this).formatCurrency(),feechangecalc()}),$(".complexfee input").change(function(){$(this).formatCurrency(),recalculatefees()}),$(document).ready($(function(){$("#recmoney").hide(),$("#new_policypremiumtransaction").validate({rules:{"policypremiumtransaction[base_premium]":{required:!0,greaterThanZero:!0},"policypremiumtransaction[taxes]":{greaterThanZero:!0},"policypremiumtransaction[fees]":{greaterThanEqualZero:!0},"policypremiumtransaction[total_premium]":{greaterThanZero:!0}}}),jQuery.validator.addMethod("greaterThanZero",function(e,t){var a=e.replace(/[^0-9\.\(\)]+/g,"");return this.optional(t)||0<parseFloat(a).toFixed(2)},"* Amount must be greater than zero"),jQuery.validator.addMethod("greaterThanEqualZero",function(e,t){var a=e.replace(/[^0-9\.\(\)]+/g,"");return this.optional(t)||0<=parseFloat(a).toFixed(2)},"* Amount must not be negative")}));