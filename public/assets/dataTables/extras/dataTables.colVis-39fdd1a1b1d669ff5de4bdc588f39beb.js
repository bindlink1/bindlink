/*! ColVis 1.1.2
 * Â©2010-2015 SpryMedia Ltd - datatables.net/license
 */
/**
 * @summary     ColVis
 * @description Controls for column visibility in DataTables
 * @version     1.1.2
 * @file        dataTables.colReorder.js
 * @author      SpryMedia Ltd (www.sprymedia.co.uk)
 * @contact     www.sprymedia.co.uk/contact
 * @copyright   Copyright 2010-2015 SpryMedia Ltd.
 *
 * This source file is free software, available under the following license:
 *   MIT license - http://datatables.net/license/mit
 *
 * This source file is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 *
 * For details please refer to: http://www.datatables.net
 */
!function(t,h,c){var n=function(d){"use strict";var e=function(t,n){this.CLASS&&"ColVis"==this.CLASS||alert("Warning: ColVis must be initialised with the keyword 'new'"),void 0===n&&(n={});var s=d.fn.dataTable.camelToHungarian;return s&&(s(e.defaults,e.defaults,!0),s(e.defaults,n)),this.s={dt:null,oInit:n,hidden:!0,abOriginal:[]},this.dom={wrapper:null,button:null,collection:null,background:null,catcher:null,buttons:[],groupButtons:[],restore:null},e.aInstances.push(this),this.s.dt=d.fn.dataTable.Api?new d.fn.dataTable.Api(t).settings()[0]:t,this._fnConstruct(n),this};return e.prototype={button:function(){return this.dom.wrapper},fnRebuild:function(){this.rebuild()},rebuild:function(){for(var t=this.dom.buttons.length-1;0<=t;t--)this.dom.collection.removeChild(this.dom.buttons[t]);this.dom.buttons.splice(0,this.dom.buttons.length),this.dom.groupButtons.splice(0,this.dom.groupButtons.length),this.dom.restore&&this.dom.restore.parentNode(this.dom.restore),this._fnAddGroups(),this._fnAddButtons(),this._fnDrawCallback()},_fnConstruct:function(t){this._fnApplyCustomisation(t);var i,e,a=this;for(this.dom.wrapper=h.createElement("div"),this.dom.wrapper.className="ColVis",this.dom.button=d("<button />",{"class":this.s.dt.bJUI?"ColVis_Button ColVis_MasterButton ui-button ui-state-default":"ColVis_Button ColVis_MasterButton"}).append("<span>"+this.s.buttonText+"</span>").bind("mouseover"==this.s.activate?"mouseover":"click",function(t){t.preventDefault(),a._fnCollectionShow()}).appendTo(this.dom.wrapper)[0],this.dom.catcher=this._fnDomCatcher(),this.dom.collection=this._fnDomCollection(),this.dom.background=this._fnDomBackground(),this._fnAddGroups(),this._fnAddButtons(),i=0,e=this.s.dt.aoColumns.length;i<e;i++)this.s.abOriginal.push(this.s.dt.aoColumns[i].bVisible);this.s.dt.aoDrawCallback.push({fn:function(){a._fnDrawCallback.call(a)},sName:"ColVis"}),d(this.s.dt.oInstance).bind("column-reorder.dt",function(t,n,s){for(i=0,e=a.s.aiExclude.length;i<e;i++)a.s.aiExclude[i]=s.aiInvertMapping[a.s.aiExclude[i]];var o=a.s.abOriginal.splice(s.iFrom,1)[0];a.s.abOriginal.splice(s.iTo,0,o),a.fnRebuild()}),d(this.s.dt.oInstance).bind("destroy.dt",function(){d(a.dom.wrapper).remove()}),this._fnDrawCallback()},_fnApplyCustomisation:function(t){d.extend(!0,this.s,e.defaults,t),!this.s.showAll&&this.s.bShowAll&&(this.s.showAll=this.s.sShowAll),!this.s.restore&&this.s.bRestore&&(this.s.restore=this.s.sRestore);var n=this.s.groups,s=this.s.aoGroups;if(n)for(var o=0,i=n.length;o<i;o++)n[o].title&&(s[o].sTitle=n[o].title),n[o].columns&&(s[o].aiColumns=n[o].columns)},_fnDrawCallback:function(){for(var t,o=this.s.dt.aoColumns,n=this.dom.buttons,s=this.s.aoGroups,i=0,e=n.length;i<e;i++)(t=n[i]).__columnIdx!==c&&d("input",t).prop("checked",o[t.__columnIdx].bVisible);for(var a=function(t){for(var n=0,s=t.length;n<s;n++)if(!1===o[t[n]].bVisible)return!1;return!0},l=function(t){for(var n=0,s=t.length;n<s;n++)if(!0===o[t[n]].bVisible)return!1;return!0},u=0,r=s.length;u<r;u++)a(s[u].aiColumns)?(d("input",this.dom.groupButtons[u]).prop("checked",!0),d("input",this.dom.groupButtons[u]).prop("indeterminate",!1)):l(s[u].aiColumns)?(d("input",this.dom.groupButtons[u]).prop("checked",!1),d("input",this.dom.groupButtons[u]).prop("indeterminate",!1)):d("input",this.dom.groupButtons[u]).prop("indeterminate",!0)},_fnAddGroups:function(){var t;if("undefined"!=typeof this.s.aoGroups)for(var n=0,s=this.s.aoGroups.length;n<s;n++)t=this._fnDomGroupButton(n),this.dom.groupButtons.push(t),this.dom.buttons.push(t),this.dom.collection.appendChild(t)},_fnAddButtons:function(){var t,i=this.s.dt.aoColumns;if(-1===d.inArray("all",this.s.aiExclude))for(var n=0,s=i.length;n<s;n++)-1===d.inArray(n,this.s.aiExclude)&&((t=this._fnDomColumnButton(n)).__columnIdx=n,this.dom.buttons.push(t));"alpha"===this.s.order&&this.dom.buttons.sort(function(t,n){var s=i[t.__columnIdx].sTitle,o=i[n.__columnIdx].sTitle;return s===o?0:s<o?-1:1}),this.s.restore&&((t=this._fnDomRestoreButton()).className+=" ColVis_Restore",this.dom.buttons.push(t)),this.s.showAll&&((t=this._fnDomShowXButton(this.s.showAll,!0)).className+=" ColVis_ShowAll",this.dom.buttons.push(t)),this.s.showNone&&((t=this._fnDomShowXButton(this.s.showNone,!1)).className+=" ColVis_ShowNone",this.dom.buttons.push(t)),d(this.dom.collection).append(this.dom.buttons)},_fnDomRestoreButton:function(){var s=this,t=this.s.dt;return d('<li class="ColVis_Special '+(t.bJUI?"ui-button ui-state-default":"")+'">'+this.s.restore+"</li>").click(function(){for(var t=0,n=s.s.abOriginal.length;t<n;t++)s.s.dt.oInstance.fnSetColumnVis(t,s.s.abOriginal[t],!1);s._fnAdjustOpenRows(),s.s.dt.oInstance.fnAdjustColumnSizing(!1),s.s.dt.oInstance.fnDraw(!1)})[0]},_fnDomShowXButton:function(t,s){var o=this,n=this.s.dt;return d('<li class="ColVis_Special '+(n.bJUI?"ui-button ui-state-default":"")+'">'+t+"</li>").click(function(){for(var t=0,n=o.s.abOriginal.length;t<n;t++)-1===o.s.aiExclude.indexOf(t)&&o.s.dt.oInstance.fnSetColumnVis(t,s,!1);o._fnAdjustOpenRows(),o.s.dt.oInstance.fnAdjustColumnSizing(!1),o.s.dt.oInstance.fnDraw(!1)})[0]},_fnDomGroupButton:function(t){var o=this,n=this.s.dt,i=this.s.aoGroups[t];return d('<li class="ColVis_Special '+(n.bJUI?"ui-button ui-state-default":"")+'"><label><input type="checkbox" /><span>'+i.sTitle+"</span></label></li>").click(function(t){var n=!d("input",this).is(":checked");"li"!==t.target.nodeName.toLowerCase()&&(n=!n);for(var s=0;s<i.aiColumns.length;s++)o.s.dt.oInstance.fnSetColumnVis(i.aiColumns[s],n)})[0]},_fnDomColumnButton:function(o){var i=this,t=this.s.dt.aoColumns[o],e=this.s.dt,n=null===this.s.fnLabel?t.sTitle:this.s.fnLabel(o,t.sTitle,t.nTh);return d("<li "+(e.bJUI?'class="ui-button ui-state-default"':"")+'><label><input type="checkbox" /><span>'+n+"</span></label></li>").click(function(t){var n=!d("input",this).is(":checked");"li"!==t.target.nodeName.toLowerCase()&&("input"!=t.target.nodeName.toLowerCase()&&null!==i.s.fnStateChange||(n=!n));var s=d.fn.dataTableExt.iApiIndex;d.fn.dataTableExt.iApiIndex=i._fnDataTablesApiIndex.call(i),e.oFeatures.bServerSide?(i.s.dt.oInstance.fnSetColumnVis(o,n,!1),i.s.dt.oInstance.fnAdjustColumnSizing(!1),""===e.oScroll.sX&&""===e.oScroll.sY||i.s.dt.oInstance.oApi._fnScrollDraw(i.s.dt),i._fnDrawCallback()):i.s.dt.oInstance.fnSetColumnVis(o,n),d.fn.dataTableExt.iApiIndex=s,null!==i.s.fnStateChange&&("span"==t.target.nodeName.toLowerCase()&&t.preventDefault(),i.s.fnStateChange.call(i,o,n))})[0]},_fnDataTablesApiIndex:function(){for(var t=0,n=this.s.dt.oInstance.length;t<n;t++)if(this.s.dt.oInstance[t]==this.s.dt.nTable)return t;return 0},_fnDomCollection:function(){return d("<ul />",{"class":this.s.dt.bJUI?"ColVis_collection ui-buttonset ui-buttonset-multi":"ColVis_collection"}).css({display:"none",opacity:0,position:this.s.bCssPosition?"":"absolute"})[0]},_fnDomCatcher:function(){var t=this,n=h.createElement("div");return n.className="ColVis_catcher",d(n).click(function(){t._fnCollectionHide.call(t,null,null)}),n},_fnDomBackground:function(){var t=this,n=d("<div></div>").addClass("ColVis_collectionBackground").css("opacity",0).click(function(){t._fnCollectionHide.call(t,null,null)});return"mouseover"==this.s.activate&&n.mouseover(function(){t.s.overcollection=!1,t._fnCollectionHide.call(t,null,null)}),n[0]},_fnCollectionShow:function(){var t,n=this,s=d(this.dom.button).offset(),o=this.dom.collection,i=this.dom.background,e=parseInt(s.left,10),a=parseInt(s.top+d(this.dom.button).outerHeight(),10);this.s.bCssPosition||(o.style.top=a+"px",o.style.left=e+"px"),d(o).css({display:"block",opacity:0}),i.style.bottom="0px",i.style.right="0px";var l=this.dom.catcher.style;if(l.height=d(this.dom.button).outerHeight()+"px",l.width=d(this.dom.button).outerWidth()+"px",l.top=s.top+"px",l.left=e+"px",h.body.appendChild(i),h.body.appendChild(o),h.body.appendChild(this.dom.catcher),d(o).animate({opacity:1},n.s.iOverlayFade),d(i).animate({opacity:.1},n.s.iOverlayFade,"linear",function(){d.browser&&d.browser.msie&&"6.0"==d.browser.version&&n._fnDrawCallback()}),!this.s.bCssPosition){t="left"==this.s.sAlign?e:e-d(o).outerWidth()+d(this.dom.button).outerWidth(),o.style.left=t+"px";var u=d(o).outerWidth(),r=(d(o).outerHeight(),d(h).width());r<t+u&&(o.style.left=r-u+"px")}this.s.hidden=!1},_fnCollectionHide:function(){var t=this;this.s.hidden||null===this.dom.collection||(this.s.hidden=!0,d(this.dom.collection).animate({opacity:0},t.s.iOverlayFade,function(){this.style.display="none"}),d(this.dom.background).animate({opacity:0},t.s.iOverlayFade,function(){h.body.removeChild(t.dom.background),h.body.removeChild(t.dom.catcher)}))},_fnAdjustOpenRows:function(){for(var t=this.s.dt.aoOpenRows,n=this.s.dt.oApi._fnVisbleColumns(this.s.dt),s=0,o=t.length;s<o;s++)t[s].nTr.getElementsByTagName("td")[0].colSpan=n}},e.fnRebuild=function(t){var n=null;void 0!==t&&(n=d.fn.dataTable.Api?new d.fn.dataTable.Api(t).table().node():t.fnSettings().nTable);for(var s=0,o=e.aInstances.length;s<o;s++)void 0!==t&&n!=e.aInstances[s].s.dt.nTable||e.aInstances[s].fnRebuild()},e.defaults={active:"click",buttonText:"Show / hide columns",aiExclude:[],bRestore:!1,sRestore:"Restore original",bShowAll:!1,sShowAll:"Show All",sAlign:"left",fnStateChange:null,iOverlayFade:500,fnLabel:null,bCssPosition:!1,aoGroups:[],order:"column"},e.aInstances=[],e.prototype.CLASS="ColVis",e.VERSION="1.1.2",e.prototype.VERSION=e.VERSION,"function"==typeof d.fn.dataTable&&"function"==typeof d.fn.dataTableExt.fnVersionCheck&&d.fn.dataTableExt.fnVersionCheck("1.7.0")?d.fn.dataTableExt.aoFeatures.push({fnInit:function(t){var n=t.oInit;return new e(t,n.colVis||n.oColVis||{}).button()},cFeature:"C",sFeature:"ColVis"}):alert("Warning: ColVis requires DataTables 1.7 or greater - www.datatables.net/download"),d.fn.dataTable.ColVis=e,d.fn.DataTable.ColVis=e};"function"==typeof define&&define.amd?define(["jquery","datatables"],n):"object"==typeof exports?n(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.ColVis&&n(jQuery,jQuery.fn.dataTable)}(window,document);